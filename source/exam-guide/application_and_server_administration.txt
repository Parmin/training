================================================
Application and Server Administration (DBA Only)
================================================

For the Certification Exam, students will be expected to:

- Understand the purpose of the journal, the log, and security.
- Know the advantages/disadvantages of different cluster architecture options.
- Be able to evaluate options about basic server diagnostics, maintenance, backup, and disaster recovery.


Application and Server Administration Topics
--------------------------------------------

- Journal
- Server Logs
- The Profiler
- MongoDB Security

  - MongoDB CR

    - User roles

  - Security Features Available

- Cluster Architecture
- Diagnostics and Debugging
- Maintenance
- Backup
- Recovery


Introduction
------------

While the definitions are somewhat fluid, Application Administration deals with MongoDB's relationship to applications. Since MongoDB is a flexible data store, it's basically never used alone, except for training purposes. It's always hooked into an application, and this requires a certain set of features to assist with the interface, such as the wire protocol, over-the-wire encryption, and security. 

Server administration deals with all other aspects of architecting, maintaining, or repairing the server system. While Sharding and Replication are big enough to merit their own sections in the exam, this should cover almost everything else.


Journal
-------

MongoDB's journal is a "write ahead" log used to ensure consistency of data on disk for MMAPv1 (though it's not necessary for WiredTiger), and also is used to frequently commit writes to disk.

Videos:

  - `Journal's impact on resident memory <https://university.mongodb.com/videos/y/8TmmEzm50cw>`_

Docs:

  - :manual:`Journaling Mechanics</core/journaling/>`
  - :manual:`Manage Journaling</tutorial/manage-journaling/>`

Blog:

  - `How MongoDB's Journaling Works <http://blog.mongodb.org/post/33700094220/how-mongodbs-journaling-works>`_

.. _How MongoDB's Journaling Works: 

Server Logs
-----------

The server logs capture several things by default: connections, the creation/dropping of collections/databases, and long-running events (more than 100 ms), among other things. You'll need to know the things at about this level, but you won't need to know things much deeper than that.

Docs:

  - :manual:`Log Messages</reference/log-messages/>`
  - :manual:`Rotate Log Files</tutorial/rotate-log-files/>`
  - :manual:`Process Logging</administration/monitoring/#process-logging>`

Videos:

  - `Examining Log Files <https://university.mongodb.com/videos/y/qc1hOvhCohY>`_


The Profiler
------------

Docs:

  - :manual:`Database Profiling</administration/analyzing-mongodb-performance/#database-profiling>`


Videos:

  - `Profiler Demo <https://university.mongodb.com/videos/y/_ApSNwSRYVo>`_
  - `Profiling Overview <https://university.mongodb.com/videos/y/ww5pYJqukAg>`_
  - `Profiler Helper Function <https://university.mongodb.com/videos/y/_ApSNwSRYVo>`_
  - `Examining Profiler Operations <https://university.mongodb.com/videos/y/FSrJz_hkisM>`_
  - `Filtering the Profiler by Timestamp <https://university.mongodb.com/videos/y/P6igqf5Vc9w>`_


Monitoring and Performance Tuning
---------------------------------

Docs:

  - :manual:`Monitoring for MongoDB</administration/monitoring/>`
  - :manual:`Analyzing MongoDB Performance</administration/analyzing-mongodb-performance/>`


MongoDB Security
----------------

For security, you should be familiar with MongoDB-CR (defining user roles and permissions) to the extent of knowing the roles and how to set permissions. You should also know about the other options and best practices for MongoDB's security features, but will not need to know details about them for the certification exam.

Docs:

  - :manual:`Security Introduction</core/security-introduction/>`
  - :manual:`Authentication</core/authentication/>`
  - :manual:`Authorization</core/authorization/>`
  - :manual:`Network Exposure and Security</core/security-network/>`
  - :manual:`Collection-Level Access Control</core/collection-level-access-control/>`
  - :manual:`Auditing</core/auditing/>`
  - :manual:`Kerberos Authentication</core/kerberos/>`
  - `MongoDB Security Guide <http://docs.mongodb.org/master/MongoDB-security-guide.pdf>`_
  - :manual:`Security Tutorials</administration/security/>`


Cluster Architecture
--------------------

Know about patterns. For example, in a replica set, know that you should have an odd number of members in, distributit across data centers, and use cases for tags. For a sharded cluster, understand tag based sharding, tag use cases, and  Some of this is covered in Replication and Sharding, but where those sections largerly are concerned with what can be done, this section emphasizes what should be done.

- :manual:`Replica Set Deployment Architectures</core/replica-set-architectures/>`
- :manual:`Sharded Cluster Requirements</core/sharded-cluster-requirements/>`
- :manual:`Production Cluster Architecture</core/sharded-cluster-architectures-production/>`
- :manual:`Config Server Availability</core/sharded-cluster-config-servers/#config-server-availability>`


Diagnostics and Debugging
-------------------------

This section captures anything that isn't captured elsewhere (such as the server tools sections, the logs, or the profiler), and questions will either ask how to use those tools, or what tools are the right tool for a particular problem or piece of information you're trying to gather. For any commands listed here, be familiar with how to use the command, and how to interpret what it returns.

Docs:

  - :manual:`db.currentOp()</reference/method/db.currentOp/>`
  - :manual:`db.serverStatus()</reference/method/db.serverStatus/>`
  - :manual:`Diagnostics</faq/diagnostics/>`
  - :manual:`rs.status()</reference/method/rs.status/>`
  - :manual:`sh.status()</reference/method/sh.status/>`

Webinar:

  - `Diagnostics and Debugging <https://www.mongodb.com/presentations/webinar-diagnostics-and-debugging-mongodb>`_


Maintenance
-----------

You should know the procedure for rotating log files, upgrade your servers (hot), and removing shards from a cluster. You should also know how to kill long-running processes manually.

Docs:

  - `Rotate Log Files <http://docs.mongodb.org/v2.6/tutorial/rotate-log-files/>`_
  - `Upgrade to the Latest Version of MongoDB <http://docs.mongodb.org/v2.6/tutorial/upgrade-revision/>`_
  - :manual:`db.killOp()</reference/method/db.killOp/>`

Videos:

  - `Removing a Shard <https://university.mongodb.com/videos/y/kSlGXXe215Q>`_
  - `Upgrading a Sharded Cluster <https://university.mongodb.com/videos/y/3XrnQ9yFwfU>`_


Backup and Recovery
-------------------

You will need to be familiar with your backup options.

Keep in mind, most of the trouble people have with backups is restoring to them. You should also be familiar with your options for restoring data in the event of server failure.

Docs:

 - :manual:`Backup and Restore with Filesystem Snapshots</tutorial/backup-with-filesystem-snapshots/>`
 - :manual:`Restore a Replica Set from MongoDB Backups</tutorial/restore-replica-set-from-backup/>`
 - `Backup and Restore with MongoDB Tools <http://docs.mongodb.org/v2.6/tutorial/backup-with-mongodump/>`_

Videos:

  - `Overview of Backing Up <https://university.mongodb.com/videos/y/hl58MKd2jCs>`_
  - `Mongodump <https://university.mongodb.com/videos/y/tbQE2ZPPbHA>`_
  - `Filesystem Snapshot <https://university.mongodb.com/videos/y/6A_jy8_YRIg>`_
  - `Backing Up a Sharded Cluster <https://university.mongodb.com/videos/y/DAWoj5Hd2Mo>`_
  - `Backup Strategies <https://university.mongodb.com/videos/y/7x9UPaq-i78>`_


Further Exercises
-----------------

- Create a replica set or sharded cluster. Create a database, and then drop it. Put the server under a simulated load, and then insert an array of large documents (~15 MB), preferably as a bulk insert. Check the server logs and try to find the long-running events.
- Run a mongod with --auth. Log in, and create a User Admin, and use that login to create a user with Read permissions in one database and ReadWrite permissions in another. Verify that you are able to login and read/write as appropriate, and are locked out of other databases.
- Backup your data with a filesystem snapshot. Drop your database, and restore from the backup. Repeat for mongodump/mongorestore.
- Turn on the profiler to level 2, and then perform some read queries, and some write queries. Find out how long they took. Don't forget to set the profiler back to level 0.
- Turn on the profiler to level 1, and try to create some long-running queries that get captured.
- Start a long-running process, then use db.currentOp() and db.killOp() to find and kill it.
