============
Server Tools
============

For the certification exam, will will verify that you understand:

- How to export and import data using server tools
- How to monitor basic operations on the server using server tools
- How to backup and restore data and examine backed-up data using server tools (DBA only)
- Which tools to use to sniff network data, manipulate GridFS files, and analyze disk I/O (DBA only)


Introduction
------------

Most of the information tested can be found by running the tools with the --help option.

For the Developer exam, you will need to know:

- mongoimport
- mongoexport
- mongostat
- mongotop

For the DBA exam, you will need to know:

- mongoimport
- mongoexport
- mongostat
- mongotop
- mongodump
- mongorestore
- mongosniff
- mongofiles
- bsondump
- mongoperf


Importing and Exporting Data
----------------------------

For the exam, you should know how to import/export data between MongoDB and:

- JSON files
- CSV files

Resources:

- Docs:

  - `mongoimport docs <https://docs.mongodb.org/v3.0/reference/program/mongoimport/>`_
  - `mongoexport docs <https://docs.mongodb.org/v3.0/reference/program/mongoexport/>`_
  - `mongostat docs <https://docs.mongodb.org/v3.0/reference/program/mongostat/>`_
  - `mongotop docs <https://docs.mongodb.org/v3.0/reference/program/mongotop/>`_

- Videos:

  - `Importing from Reddit <https://university.mongodb.com/videos/y/oVmoi6fS4X8>`_


Basic Server Monitoring
-----------------------

For the exam, you should know:

- How to use mongostat to monitor MongoDB for both the MMAPv1 and WiredTiger storage engines 
- How to use mongotop to look at server activity
- What fields are of particular interest when diagnosing certain types of performance problems in both mongostat and mongotop

Resources: 

- Docs:

  - :manual:`mongostat</reference/program/mongostat/>`
  - :manual:`mongotop</reference/program/mongotop/>`

- Videos:

  - `mongostat video <https://university.mongodb.com/videos/y/E2aDTSes3Wc>`_
  - `mongotop video <https://university.mongodb.com/videos/y/D9YLXgy7NYo>`_


Backing up and Restoring Data (DBA Only)
----------------------------------------

For the exam, you should know:

- How to use mongodump and mongorestore to save and restore data
- How to include your oplog in a mongodump or mongorestore

Resources:

- Docs:

  - :manual:`mongodump</reference/program/mongodump/>`
  - :manual:`mongorestore</reference/program/mongorestore/>`

- Video:

  - `MongoDB tools for backup <https://university.mongodb.com/videos/y/Ln6gyZ_0yDk>`_


Advanced MongoDB Diagnostics (DBA Only)
---------------------------------------

For the exam, you should know how to use the following tools:

- mongosniff
- bsondump
- mongoperf

Resources:

- :manual:`mongosniff</reference/program/mongosniff/>`
- :manual:`bsondump</reference/program/bsondump/>`
- :manual:`mongoperf</reference/program/mongoperf/>`


Manipulating BLOBs (DBA only)
-----------------------------

For the exam, you will need to be able to use mongofiles to put data into GridFS.

Resources:

- :manual:`mongofiles</reference/program/mongofiles/>`



Exercises for the Reader
------------------------

- For each of the server tools listed above, run the tool with --help.
- Run mongostat.

  - Write a little code that bulk inserts 1,000 small documents per batch as fast as possible for at least a minute.
  - Run the code and look at the output of mongostat, and compare it with your expectations. Pay attention to each field.
  
- Run mongostat.

  - Then, write a little code that individually inserts one large document (100+ kb per insert) at a time as fast as possible for at least a minute.
  - Run it and look at the output of mongostat, comparing the output with your expectations.
  - Pay attention to each field. This time, try to use a different storage engine than you did last time.
  
- Run mongotop.

  - Using a script from either mongostat exercise, begin inserting data, and also run some queries in another database.
  - Look at the output of mongotop.

- For mongoperf, run a similar experiment as you did for mongotop.

- Import a JSON file into a MongoDB collection. You might find one at Reddit's technology subreddit, the Enron email data set, or find something else on the web.

  - `Technology Subreddit <https://www.reddit.com/r/technology/.json>`_
  - `Enron email data set <http://www.cs.cmu.edu/~enron/>`_
  - You may find that the format isn't quite what you want. Transform it, either with a script or with the aggregation pipeline, using $out, into a more usable form.

- Find a CSV data set from US public data, and import it. If you don't like its initial format, you can transform it and put it in a new collection using the aggregation pipeline's $out function.

  - `US public data <https://catalog.data.gov/dataset?res_format=CSV>`_

- Perform a mongodump.

  - Look at the output using bsondump.
  - Drop the database and then use mongorestore to get it back from your backup.

- Run a mongodump with the --oplog option and compare the mongorestore with the --oplog replay option and without.

- If you are running a Linux machine, run mongosniff and run some queries; find them using mongosniff.


