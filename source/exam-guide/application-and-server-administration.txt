================================================
Application and Server Administration (DBA Only)
================================================

For the certification exam, we will verify that you:

- Understand the mechanics of the MongoDB journal and server logs
- Understand MongoDB security
- Can identify the advantages and disadvantages of different cluster architectures
- Be able to evaluate options about basic server diagnostics, maintenance, backup, and disaster recovery.


Introduction
------------

While the definitions are somewhat fluid, Application Administration deals with MongoDB's relationship to applications. The features we consider here include: the wire protocol, over-the-wire encryption, and security. 

Server administration deals with architecting, maintaining, and debugging a deployment. 


Journal
-------

For the exam, you should know:

- The purpose of the journal
- That the journal is implemented as a binary write-ahead log
- Why the journal ensures consistent data in the event of server failure for MMAPv1
- Why the journal is unnecessary for WiredTiger
- The fundamentals of how the journal works, e.g., how often data is flushed to disk, for both MMAPv1 and WiredTiger

Resources:

- Videos:

  - `Journal's impact on resident memory <https://university.mongodb.com/videos/y/8TmmEzm50cw>`_

- Docs:

  - :manual:`Journaling Mechanics</core/journaling/>`
  - :manual:`Manage Journaling</tutorial/manage-journaling/>`

- Blog:

  - `How MongoDB's Journaling Works <http://blog.mongodb.org/post/33700094220/how-mongodbs-journaling-works>`_


Server Logs
-----------

For the exam, you should to know:

- What queries get captured in the server logs
- How to rotate log files
- Common events that get captured:

  - Creating/dropping databases
  - Connections

- Docs:

  - :manual:`Log Messages</reference/log-messages/>`
  - :manual:`Rotate Log Files</tutorial/rotate-log-files/>`
  - :manual:`Process Logging</administration/monitoring/#process-logging>`

- Videos:

  - `Examining Log Files <https://university.mongodb.com/videos/y/qc1hOvhCohY>`_


The Profiler
------------

For the exam, you should know:

- How to turn the profiler on and off or change its settings
- What the profiler captures
- Where that information is stored

Resources:

- Docs:

  - :manual:`Database Profiling</administration/analyzing-mongodb-performance/#database-profiling>`

- Videos:

  - `Profiler Demo <https://university.mongodb.com/videos/y/_ApSNwSRYVo>`_
  - `Profiling Overview <https://university.mongodb.com/videos/y/ww5pYJqukAg>`_
  - `Profiler Helper Function <https://university.mongodb.com/videos/y/_ApSNwSRYVo>`_
  - `Examining Profiler Operations <https://university.mongodb.com/videos/y/FSrJz_hkisM>`_
  - `Filtering the Profiler by Timestamp <https://university.mongodb.com/videos/y/P6igqf5Vc9w>`_


Monitoring and Performance Tuning
---------------------------------

For the exam, you will need to know:

- What tools are available to monitor and tune MongoDB
- How to interpret their output for simple scenarios, such as:

  - Working set has outgrown RAM
  - Contention is limiting write speed (MMAPv1)
  - Disk I/O is saturated

Resources:

- :manual:`Monitoring for MongoDB</administration/monitoring/>`
- :manual:`Analyzing MongoDB Performance</administration/analyzing-mongodb-performance/>`


MongoDB Security
----------------

For the exam, you should know:

- How to define user roles and permissions in MongoDB Challenge and Response (MongoDB-CR)
- Which other security best practices are available

Resources:

- :manual:`Security Introduction</core/security-introduction/>`
- :manual:`Authentication</core/authentication/>`
- :manual:`Authorization</core/authorization/>`
- :manual:`Hardening Network Infrastructure</core/security-network/>`
- :manual:`Collection-Level Access Control</core/collection-level-access-control/>`
- :manual:`Auditing</core/auditing/>`
- :manual:`Security Tutorials</administration/security/>`


Cluster Architecture
--------------------

For the exam, you should know common deployment patterns for:
  
- Replica sets
- Sharded clusters

Resources:

- :manual:`Replica Set Deployment Architectures</core/replica-set-architectures/>`
- :manual:`Sharded Cluster Requirements</core/sharded-cluster-requirements/>`
- :manual:`Production Cluster Architecture</core/sharded-cluster-architectures-production/>`
- :manual:`Config Server Availability</core/sharded-cluster-config-servers/#config-server-availability>`


Diagnostics and Debugging
-------------------------

For the exam, you should know:

- Basic commands to look at server, replica set, and sharded cluster status
- How to interpret those commands
- Solutions to simple problems that may arise, such as:

  - A server is down
  - A config server is down
  - A long-running query is grabbing too many resources
  - All queries are confined to one server in a sharded cluster

Resources:

- Docs:

  - :manual:`db.currentOp()</reference/method/db.currentOp/>`
  - :manual:`db.serverStatus()</reference/method/db.serverStatus/>`
  - :manual:`Diagnostics</faq/diagnostics/>`
  - :manual:`rs.status()</reference/method/rs.status/>`
  - :manual:`sh.status()</reference/method/sh.status/>`
  - :manual:`db.killOp()</reference/method/db.killOp/>`

- Webinar:

  - `Diagnostics and Debugging <https://www.mongodb.com/presentations/webinar-diagnostics-and-debugging-mongodb>`_


Maintenance
-----------

For the exam, you should be able to:

- Rotate log files
- Create new users in MongoDB-CR
- Remove a shard from a sharded cluster

Resources:

- Docs:

  - `Rotate Log Files <http://docs.mongodb.org/v2.6/tutorial/rotate-log-files/>`_
  - `Upgrade to the Latest Version of MongoDB <http://docs.mongodb.org/v2.6/tutorial/upgrade-revision/>`_

- Videos:

  - `Removing a Shard <https://university.mongodb.com/videos/y/kSlGXXe215Q>`_
  - `Upgrading a Sharded Cluster <https://university.mongodb.com/videos/y/3XrnQ9yFwfU>`_


Backup and Recovery
-------------------

For the exam, you will need to know:

- Backup options for individual servers and clusters

  - Filesystem snapshots
  - mongodump

- How to restore data from these backups

Resources:

- Docs:

  - :manual:`Backup and Restore with Filesystem Snapshots</tutorial/backup-with-filesystem-snapshots/>`
  - :manual:`Restore a Replica Set from MongoDB Backups</tutorial/restore-replica-set-from-backup/>`
  - `Backup and Restore with MongoDB Tools <http://docs.mongodb.org/v2.6/tutorial/backup-with-mongodump/>`_

- Videos:

  - `Overview of Backing Up <https://university.mongodb.com/videos/y/hl58MKd2jCs>`_
  - `Mongodump <https://university.mongodb.com/videos/y/tbQE2ZPPbHA>`_
  - `Filesystem Snapshot <https://university.mongodb.com/videos/y/6A_jy8_YRIg>`_
  - `Backing Up a Sharded Cluster <https://university.mongodb.com/videos/y/DAWoj5Hd2Mo>`_
  - `Backup Strategies <https://university.mongodb.com/videos/y/7x9UPaq-i78>`_


Exercises for the Reader
------------------------

- Find long-running events:

  - Create a replica set or sharded cluster.
  - Create a database, and then drop it.
  - Put the server under a simulated load and then insert an array of large documents (~15 MB), preferably as a bulk insert.
  - Check the server logs and try to find the long-running events.

- Create a user admin

  - Run a mongod with the --auth flag.
  - Log in and create a User Admin
  - Use that login to create a user with Read permissions in one database and ReadWrite permissions in another.
  - Verify that you are able to login and read/write as appropriate, and are locked out of other databases.

- Backup some data

  - Use a working MongoDB deployment.
  - Backup your data with a filesystem snapshot.
  - Drop your database, and restore from the backup.
  - Repeat for mongodump/mongorestore.

- Long-running queries

  - Turn on the profiler set to level 2.
  - Perform some reads and some write queries.
  - Find out how long they took.
  - Don't forget to set the profiler back to level 0.

- Kill a long-running process

  - Turn on the profiler set to level 1.
  - Create some long-running queries.
  - Start a long-running process.
  - Use db.currentOp() and db.killOp() to find and kill the long running process.
