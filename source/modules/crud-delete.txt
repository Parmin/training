==================
Removing Documents
==================

.. topic:: Learning objectives

    Students should understand:

        - How to remove documents from a collection
        - How to limit the number of documents removed from a collection to 1
        - How to remove a collection from a database
        - How to remove a database from the server

Using the db.collection.remove() Function
=========================================

- You can remove documents with the db.collection.remove() function
    - This function has one required parameter, a query/matching document
    - Prior to 2.6, calling the function with no parameters would remove all
      documents from the collection; after 2.6, you need to call it with an
      empty document to remove all documents
- All matching documents will be removed
- If you would like to limit it to one document, you can use an options
  document with justOne : true

Exercise: Removing documents
----------------------------

.. code-block:: javascript

    for (i=1; i<=100; i++) { 
        db.removingDocuments.insert( { _id : i, a : i } ) }
    db.removingDocuments.find()
    db.removingDocuments.remove( { a : 1 } )  // Remove the first document
    db.removingDocuments.find()
    db.removingDocuments.remove( { a : { $lt : 5 } } )  // Remove four more
    db.removingDocuments.find()
    db.removingDocuments.remove( { a : { $lt : 10 } },
                                 { justOne : true } )  // Remove one more
    db.removingDocuments.find()
    db.removingDocuments.remove()  // No documents removed
    db.removingDocuments.find()
    db.removingDocuments.remove( { } )  // All documents removed
    db.removingDocuments.find()

Dropping a Collection
=====================

- You can drop an entire collection with db.collection.drop()
- Dropping the collection will not only delete the documents, it will remove
  any metadata associated with that collection
    - We haven't yet talked about metadata, but it includes things like
      indexes
- For large collections, dropping the collection can be significantly faster
  than removing the documents one by one

Exercise: Dropping a Collection
===============================

.. code-block:: javascript

    show collections  // Still shows the removingDocuments collection
    db.removingDocuments.find()  
    // No documents, even though the collection is listed in the db
    db.removingDocuments.drop()
    show collections  // collection is gone


Dropping a Database
===================

- Removes the current database, including all collections
- Does not change database context, so any further inserts will go into the
  dropped database

Exercise: Dropping a Database
-----------------------------

.. code-block:: javascript

    use temporaryDB
    db.temportyColl1.insert( { a : 1 } )
    db.temportyColl2.insert( { a : 1 } )
    show dbs  // Here they are
    show collections  // Shows the two collections
    db.dropDatabase()
    show collections  // No collections
    show dbs  // The db is gone
    use test  // take us back to the test db
