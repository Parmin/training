Application and Server Administration (DBA Only)
------------------------------------------------

For the Certification Exam, students will be expected to:

- Understand the purpose of the journal, the log, and security.
- Know the advantages/disadvantages of different cluster architecture options.
- Be able to evaluate options about basic server diagnostics, maintenance, backup, and disaster recovery.


Application and Server Administration Topics
--------------------------------------------

- Journal
- Server Logs
- The Profiler
- MongoDB Security
  - MongoDB CR
    - User roles
  - Security Features Available
- Cluster Architecture
- Diagnostics and Debugging
- Maintenance
- Backup
- Recovery


Application and Server Administration Introduction
--------------------------------------------------

While the definitions are somewhat fluid, Application Administration deals with MongoDB's relationship to applications. Since MongoDB is a flexible data store, it's basically never used alone, except for training purposes. It's always hooked into an application, and this requires a certain set of features to assist with the interface, such as the wire protocol, over-the-wire encryption, and security. 

Server administration deals with all other aspects of architecting, maintaining, or repairing the server system. While Sharding and Replication are big enough to merit their own sections in the exam, this should cover almost everything else.


Journal
-------

MongoDB's journal is a "write ahead" log used to ensure consistency of data on disk for MMAPv1 (though it's not necessary for WiredTiger), and also is used to frequently commit writes to disk.

Videos:
  - Journal's impact on resident memory_
Docs:
  - Journaling Mechanics_
  - Manage Journaling_
Blog:
  - How MongoDB's Journaling Works_

.. _Journal's impact on resident memory: https://university.mongodb.com/videos/y/8TmmEzm50cw
.. _Journaling Mechanics: http://docs.mongodb.org/manual/core/journaling/
.. _Manage Journaling: http://docs.mongodb.org/manual/tutorial/manage-journaling/
.. _How MongoDB's Journaling Works: http://blog.mongodb.org/post/33700094220/how-mongodbs-journaling-works

Server Logs
-----------

The server logs capture several things by default: connections, the creation/dropping of collections/databases, and long-running events (more than 100 ms), among other things. You'll need to know the things at about this level, but you won't need to know things much deeper than that.

Docs:
  - Log Messages_
  - Rotate Log Files_
  - Process Logging_
Videos:
  - Examining Log Files_

.. _Log Messages: http://docs.mongodb.org/manual/reference/log-messages/
.. _Rotate Log Files: http://docs.mongodb.org/manual/tutorial/rotate-log-files/
.. _Process Logging: http://docs.mongodb.org/manual/administration/monitoring/#process-logging
.. _Examining Log Files: https://university.mongodb.com/videos/y/qc1hOvhCohY

The Profiler
------------

Docs:
  - Database Profiling_

.. _Database Profiling: http://docs.mongodb.org/manual/administration/analyzing-mongodb-performance/#database-profiling

Videos:
  - Profiler Demo_
  - Profiling Overview_
  - Profiler Helper Function_
  - Examining Profiler Operations_
  - Filtering the Profiler by Timestamp_


.. _Profiler Demo: https://university.mongodb.com/videos/y/_ApSNwSRYVo
.. _Profiling Overview: https://university.mongodb.com/videos/y/ww5pYJqukAg
.. _Profiler Helper Function: https://university.mongodb.com/videos/y/_ApSNwSRYVo
.. _Examining Profiler Operations: https://university.mongodb.com/videos/y/FSrJz_hkisM
.. _Filtering the Profiler by Timestamp: https://university.mongodb.com/videos/y/P6igqf5Vc9w

Monitoring and Performance Tuning
---------------------------------

Docs:
  - Monitoring for MongoDB_ (a great page listing resources for all types of system monitoring)
  - Analyzing MongoDB Performance_

.. _Monitoring for MongoDB: http://docs.mongodb.org/manual/administration/monitoring/
.. _Analyzing MongoDB Performance: http://docs.mongodb.org/manual/administration/analyzing-mongodb-performance/

MongoDB Security
----------------

For security, you should be familiar with MongoDB-CR (defining user roles and permissions) to the extent of knowing the roles and how to set permissions. You should also know about the other options and best practices for MongoDB's security features, but will not need to know details about them for the certification exam.

Docs:
  - Security Introduction_
  - Authentication_
  - Authorization_
  - Network Exposure and Security_
  - Collection-Level Access Control_
  - Auditing_
  - Security and MongoDB API Interfaces_
  - Kerberos Authentication_
  - MongoDB Security Guide_ (A good resource when implementing security for MongoDB)
  - Security Tutorials_ (A good set of tutorials for security)
Tutorials:
  - Deploy Replica Set and Configure Authentication and Authorization_
  - Authentication Tutorials_
  - Network Security Tutorials_

.. _Security Introduction: http://docs.mongodb.org/manual/core/security-introduction/
.. _Authentication: http://docs.mongodb.org/manual/core/authentication/
.. _Authorization: http://docs.mongodb.org/manual/core/authorization/
.. _Network Exposure and Security: http://docs.mongodb.org/manual/core/security-network/
.. _Collection Level Access Control: http://docs.mongodb.org/manual/core/collection-level-access-control/
.. _Auditing: http://docs.mongodb.org/manual/core/auditing/
.. _Kerberos Authentication: http://docs.mongodb.org/manual/core/kerberos/
.. _MongoDB Security Guide: http://docs.mongodb.org/master/MongoDB-security-guide.pdf
.. _Security Tutorials: http://docs.mongodb.org/manual/administration/security/

Cluster Architecture
--------------------

Know about patterns. For example, in a replica set, know that you should have an odd number of members in, distributit across data centers, and use cases for tags. For a sharded cluster, understand tag based sharding, tag use cases, and  Some of this is covered in Replication and Sharding, but where those sections largerly are concerned with what can be done, this section emphasizes what should be done.

- Replica Set Deployment Architectures_
- Sharded Cluster Requirements_
- Production Cluster Architecture_
- Config Server Availability_

.. _Sharded Cluster Requirements: http://docs.mongodb.org/manual/core/sharded-cluster-requirements/
.. _Production Cluster Architecture: http://docs.mongodb.org/manual/core/sharded-cluster-architectures-production/
.. _Replica Set Deployment Architectures: http://docs.mongodb.org/manual/core/replica-set-architectures/
.. _Config Server Availability: http://docs.mongodb.org/manual/core/sharded-cluster-config-servers/#config-server-availability

Diagnostics and Debugging
-------------------------

This section captures anything that isn't captured elsewhere (such as the server tools sections, the logs, or the profiler), and questions will either ask how to use those tools, or what tools are the right tool for a particular problem or piece of information you're trying to gather. For any commands listed here, be familiar with how to use the command, and how to interpret what it returns.

Docs:
  - db.currentOp()_
  - db.serverStatus()_
  - Diagnostics_
  - rs.status()_
  - sh.status()_
Webinar:
  - Diagnostics and Debugging_, a great talk that touches on many topics in this section, presented by MongoDB's very engaging Asya Kamsky

.. _db.currentOp(): http://docs.mongodb.org/manual/reference/method/db.currentOp/
.. _Diagnostics: http://docs.mongodb.org/manual/faq/diagnostics/
.. _Diagnostics and Debugging: https://www.mongodb.com/presentations/webinar-diagnostics-and-debugging-mongodb
.. _db.serverStatus(): http://docs.mongodb.org/manual/reference/method/db.serverStatus/
.. _rs.status(): http://docs.mongodb.org/manual/reference/method/rs.status/
.. _sh.status(): http://docs.mongodb.org/manual/reference/method/sh.status/

Maintenance
-----------

You should know the procedure for rotating log files, upgrade your servers (hot), and removing shards from a cluster. You should also know how to kill long-running processes manually.

Docs:
  - Rotate Log Files_
  - Upgrade to the Latest Version of MongoDB_
  - db.killOp()_
Videos:
  - Removing a Shard_
  - Upgrading a Sharded Cluster_

.. _db.killOp(): http://docs.mongodb.org/manual/reference/method/db.killOp/
.. _Rotate Log Files: http://docs.mongodb.org/v2.6/tutorial/rotate-log-files/
.. _Removing a Shard: https://university.mongodb.com/videos/y/kSlGXXe215Q
.. _Upgrading a Sharded Cluster: https://university.mongodb.com/videos/y/3XrnQ9yFwfU
.. _Upgrade to the Latest Version of MongoDB: http://docs.mongodb.org/v2.6/tutorial/upgrade-revision/

Backup and Recovery
-------------------

You will need to be familiar with your backup options.

Keep in mind, most of the trouble people have with backups is restoring to them. You should also be familiar with your options for restoring data in the event of server failure.

Docs:
 - Backup and Restore with Filesystem Snapshots_
 - Restore a Replica Set from MongoDB Backups_
 - Backup and Restore with MongoDB Tools_
Videos:
  - Overview of Backing Up_
  - Mongodump_
  - Filesystem Snapshot_
  - Backing Up a Sharded Cluster_
  - Backup Strategies_

.. _Overview of Backing Up: https://university.mongodb.com/videos/y/hl58MKd2jCs
.. _Mongodump: https://university.mongodb.com/videos/y/tbQE2ZPPbHA
.. _Filesystem Snapshot: https://university.mongodb.com/videos/y/6A_jy8_YRIg
.. _Backing Up a Sharded Cluster: https://university.mongodb.com/videos/y/DAWoj5Hd2Mo
.. _Backup Strategies: https://university.mongodb.com/videos/y/7x9UPaq-i78
.. _Backup and restore with Filesystem Snapshots: http://docs.mongodb.org/manual/tutorial/backup-with-filesystem-snapshots/
.. _Restore a Replica Set from MongoDB Backups: http://docs.mongodb.org/manual/tutorial/restore-replica-set-from-backup/
.. _Backup and Restore with MongoDB Tools: http://docs.mongodb.org/v2.6/tutorial/backup-with-mongodump/

Further Exercises
-----------------

- Create a replica set or sharded cluster. Create a database, and then drop it. Put the server under a simulated load, and then insert an array of large documents (~15 MB), preferably as a bulk insert. Check the server logs and try to find the long-running events.
- Run a mongod with --auth. Log in, and create a User Admin, and use that login to create a user with Read permissions in one database and ReadWrite permissions in another. Verify that you are able to login and read/write as appropriate, and are locked out of other databases.
- Backup your data with a filesystem snapshot. Drop your database, and restore from the backup. Repeat for mongodump/mongorestore.
- Turn on the profiler to level 2, and then perform some read queries, and some write queries. Find out how long they took. Don't forget to set the profiler back to level 0.
- Turn on the profiler to level 1, and try to create some long-running queries that get captured.
- Start a long-running process, then use db.currentOp() and db.killOp() to find and kill it.
